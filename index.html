<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="theme-color" content="#1e88e5">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="description"
        content="KiÅŸisel AylÄ±k BÃ¼tÃ§e & VarlÄ±k YÃ¶netim UygulamasÄ± - Gelir, Gider, BorÃ§, YatÄ±rÄ±m Takibi">

    <title>ðŸ’¼ HÄ±zlÄ± BÃ¼tÃ§e - Gelir Gider Takibi</title>

    <!-- Favicon -->
    <link rel="icon" href="icons/icon-192.png">
    <link rel="apple-touch-icon" href="icons/icon-192.png">

    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Sora:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&display=swap"
        rel="stylesheet">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

    <!-- Tesseract.js OCR -->
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>

    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

    <link rel="stylesheet" href="css/app.css">
    <link rel="stylesheet" href="css/mobile-responsive.css">
</head>

<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="logo" onclick="window.location.reload()" style="cursor: pointer;" title="SayfayÄ± Yenile">
                    <div class="logo-icon"><i class="bi bi-wallet2"></i></div>
                    <span class="logo-text">HÄ±zlÄ± BÃ¼tÃ§e</span>
                </div>
            </div>

            <!-- Profile Selector -->
            <div class="profile-selector" onclick="openProfileModal()">
                <div class="profile-info">
                    <div class="profile-avatar" id="profileAvatar"><i class="bi bi-person-circle"></i></div>
                    <div class="profile-details">
                        <div class="profile-name" id="profileName">KiÅŸisel</div>
                        <div class="profile-currency" id="profileCurrency">â‚º TÃ¼rk LirasÄ±</div>
                    </div>
                    <span class="profile-switch-icon"><i class="bi bi-chevron-down"></i></span>
                </div>
            </div>

            <!-- Navigation Menu -->
            <nav class="nav-menu">
                <div class="nav-section">
                    <div class="nav-section-title">Ana MenÃ¼</div>
                    <div class="nav-item active" data-page="dashboard" onclick="navigateTo('dashboard')">
                        <span class="nav-icon"><i class="bi bi-calendar3"></i></span>
                        <span class="nav-label">Ajanda</span>
                    </div>
                    <div class="nav-item" data-page="transactions" onclick="navigateTo('transactions')">
                        <span class="nav-icon"><i class="bi bi-credit-card"></i></span>
                        <span class="nav-label">Ä°ÅŸlemler</span>
                    </div>
                    <div class="nav-item" data-page="categories" onclick="navigateTo('categories')">
                        <span class="nav-icon"><i class="bi bi-tags"></i></span>
                        <span class="nav-label">Kategoriler</span>
                    </div>
                </div>

                <div class="nav-section">
                    <div class="nav-section-title">YÃ¶netim</div>
                    <div class="nav-item" data-page="bills" onclick="navigateTo('bills')">
                        <span class="nav-icon"><i class="bi bi-bell"></i></span>
                        <span class="nav-label">HatÄ±rlatÄ±cÄ±lar</span>
                        <span class="nav-badge" id="billsBadge">0</span>
                    </div>
                    <div class="nav-item" data-page="debts" onclick="navigateTo('debts')">
                        <span class="nav-icon"><i class="bi bi-cash-stack"></i></span>
                        <span class="nav-label">Ã–demeler</span>
                        <span class="nav-badge" id="debtsBadge">0</span>
                    </div>
                    <div class="nav-item" data-page="investments" onclick="navigateTo('investments')">
                        <span class="nav-icon"><i class="bi bi-graph-up-arrow"></i></span>
                        <span class="nav-label">YatÄ±rÄ±mlar</span>
                    </div>
                </div>

                <div class="nav-section">
                    <div class="nav-section-title">DiÄŸer</div>
                    <div class="nav-item" data-page="sync" onclick="navigateTo('sync')">
                        <span class="nav-icon"><i class="bi bi-cloud-arrow-up"></i></span>
                        <span class="nav-label">Senkronizasyon</span>
                    </div>
                    <div class="nav-item" data-page="notes" onclick="navigateTo('notes')">
                        <span class="nav-icon"><i class="bi bi-journal-text"></i></span>
                        <span class="nav-label">Notlar</span>
                    </div>
                    <div class="nav-item" data-page="reports" onclick="navigateTo('reports')">
                        <span class="nav-icon"><i class="bi bi-bar-chart-line"></i></span>
                        <span class="nav-label">Analiz & Rapor</span>
                    </div>
                    <div class="nav-item" data-page="settings" onclick="navigateTo('settings')">
                        <span class="nav-icon"><i class="bi bi-gear"></i></span>
                        <span class="nav-label">Ayarlar</span>
                    </div>
                </div>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <div class="mobile-top-strip">Finansal Tablo</div>
            <!-- Header -->
            <header class="header">
                <div class="header-left">
                    <button class="menu-toggle" type="button" aria-label="MenÃ¼yÃ¼ aÃ§/kapat" aria-controls="sidebar"
                        onclick="toggleSidebar()"><i class="bi bi-list"></i></button>
                    <h1 class="page-title" id="pageTitle">Ajanda</h1>
                </div>
                <div class="header-right">
                    <button class="header-btn" id="undoBtn" type="button" aria-label="Geri Al"
                        onclick="TransactionManager.undo()" title="Geri Al (Ctrl+Z)" disabled style="opacity: 0.5;">
                        <i class="bi bi-arrow-counterclockwise"></i>
                    </button>
                    <button class="header-btn" id="redoBtn" type="button" aria-label="Yinele"
                        onclick="TransactionManager.redo()" title="Yinele (Ctrl+Y)" disabled style="opacity: 0.5;">
                        <i class="bi bi-arrow-clockwise"></i>
                    </button>
                    <button class="header-btn" type="button" aria-label="Tema DeÄŸiÅŸtir" onclick="toggleTheme()"
                        title="Tema DeÄŸiÅŸtir">
                        <i id="themeIcon" class="bi bi-sun-fill"></i>
                    </button>
                    <button class="header-btn" type="button" aria-label="Bildirimler" onclick="openNotifications()"
                        title="Bildirimler">
                        <i class="bi bi-bell"></i>
                    </button>
                    <button class="header-btn" type="button" aria-label="Ara" onclick="openSearch()" title="Ara">
                        <i class="bi bi-search"></i>
                    </button>
                </div>
            </header>

            <!-- Content Area -->
            <div class="content" id="mainContent">
                <!-- Dashboard / Agenda Page -->
                <div id="dashboardPage" class="page-content">
                    <!-- Summary Cards -->
                    <div class="summary-cards">
                        <div class="summary-card income">
                            <div class="summary-icon"><i class="bi bi-arrow-up-right-circle"></i></div>
                            <div class="summary-label">Bu Ay Gelir</div>
                            <div class="summary-value" id="totalIncome">â‚º0</div>
                            <div class="summary-change positive">
                                <span><i class="bi bi-arrow-up"></i></span>
                                <span id="incomeChange">+0%</span>
                                <span>geÃ§en aya gÃ¶re</span>
                            </div>
                        </div>

                        <div class="summary-card expense">
                            <div class="summary-icon"><i class="bi bi-arrow-down-right-circle"></i></div>
                            <div class="summary-label">Bu Ay Gider</div>
                            <div class="summary-value" id="totalExpense">â‚º0</div>
                            <div class="summary-change negative">
                                <span><i class="bi bi-arrow-up"></i></span>
                                <span id="expenseChange">+0%</span>
                                <span>geÃ§en aya gÃ¶re</span>
                            </div>
                        </div>

                        <div class="summary-card balance">
                            <div class="summary-icon"><i class="bi bi-wallet2"></i></div>
                            <div class="summary-label">Net Bakiye</div>
                            <div class="summary-value" id="netBalance">â‚º0</div>
                            <div class="summary-change positive">
                                <span><i class="bi bi-pie-chart"></i></span>
                                <span>Toplam varlÄ±k</span>
                            </div>
                        </div>

                        <div class="summary-card savings">
                            <div class="summary-icon"><i class="bi bi-bullseye"></i></div>
                            <div class="summary-label">Tasarruf OranÄ±</div>
                            <div class="summary-value" id="savingsRate">0%</div>
                            <div class="summary-change positive">
                                <span><i class="bi bi-stars"></i></span>
                                <span>Hedefe ulaÅŸÄ±ldÄ±</span>
                            </div>
                        </div>
                    </div>

                    <!-- Agenda Container -->
                    <div class="agenda-container">
                        <!-- Calendar Widget -->
                        <div class="calendar-widget">
                            <div class="calendar-header">
                                <h3 class="calendar-title" id="calendarTitle">Ocak 2026</h3>
                                <div class="calendar-nav">
                                    <button class="calendar-nav-btn" type="button" aria-label="Ã–nceki Ay"
                                        onclick="prevMonth()"><i class="bi bi-chevron-left"></i></button>
                                    <button class="calendar-nav-btn" type="button" aria-label="Sonraki Ay"
                                        onclick="nextMonth()"><i class="bi bi-chevron-right"></i></button>
                                </div>
                            </div>
                            <div class="calendar-grid" id="calendarGrid">
                                <!-- Calendar days will be generated by JS -->
                            </div>

                            <!-- Budget Progress -->
                            <div
                                style="margin-top: var(--spacing-lg); padding-top: var(--spacing-lg); border-top: 1px solid var(--border-color);">
                                <div
                                    style="display: flex; justify-content: space-between; margin-bottom: var(--spacing-sm);">
                                    <span style="font-size: 0.85rem; color: var(--text-secondary);">AylÄ±k BÃ¼tÃ§e</span>
                                    <span style="font-size: 0.85rem; font-weight: 600;" id="budgetProgress">â‚º0 /
                                        â‚º10,000</span>
                                </div>
                                <div
                                    style="height: 8px; background: var(--bg-input); border-radius: var(--radius-full); overflow: hidden;">
                                    <div id="budgetBar"
                                        style="height: 100%; width: 0%; background: var(--accent-gradient); border-radius: var(--radius-full); transition: width 0.5s ease;">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Transactions Panel -->
                        <div class="transactions-panel">
                            <div class="transactions-header">
                                <h3 class="transactions-title">Son Ä°ÅŸlemler</h3>
                                <div class="transactions-actions">
                                    <button class="btn btn-scan" onclick="openScanModal()" title="FiÅŸ/Fatura Tara">
                                        <i class="bi bi-camera"></i> Tara
                                    </button>
                                    <button class="btn btn-income" onclick="openAddModal('income')">
                                        <span>+</span> Gelir
                                    </button>
                                    <button class="btn btn-expense" onclick="openAddModal('expense')">
                                        <span>+</span> Gider
                                    </button>
                                </div>
                            </div>
                            <div class="transactions-list" id="transactionsList">
                                <!-- Transaction items will be generated by JS -->
                                <div class="empty-state" id="emptyTransactions">
                                    <div class="empty-state-icon"><i class="bi bi-inbox"></i></div>
                                    <div class="empty-state-title">HenÃ¼z iÅŸlem yok</div>
                                    <div class="empty-state-text">Ä°lk gelir veya giderinizi ekleyerek baÅŸlayÄ±n</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Charts Section -->
                    <div class="dashboard-grid" style="margin-top: var(--spacing-lg);">
                        <div class="chart-container">
                            <div class="chart-header">
                                <h3 class="chart-title">Gelir-Gider Trendi</h3>
                                <select class="form-input"
                                    style="width: auto; padding: var(--spacing-sm) var(--spacing-md);">
                                    <option>Son 6 Ay</option>
                                    <option>Son 12 Ay</option>
                                    <option>Bu YÄ±l</option>
                                </select>
                            </div>
                            <div class="chart-wrapper">
                                <canvas id="trendChart"></canvas>
                            </div>
                        </div>

                        <div class="chart-container">
                            <div class="chart-header">
                                <h3 class="chart-title">Kategori DaÄŸÄ±lÄ±mÄ±</h3>
                                <select class="form-input"
                                    style="width: auto; padding: var(--spacing-sm) var(--spacing-md);">
                                    <option>Bu Ay</option>
                                    <option>Son 3 Ay</option>
                                    <option>Bu YÄ±l</option>
                                </select>
                            </div>
                            <div class="chart-wrapper">
                                <canvas id="categoryChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Other pages will be loaded dynamically -->
            </div>
        </main>
    </div>

    <!-- Mobile Bottom Navigation -->
    <nav class="bottom-nav" id="bottomNav">
        <div class="bottom-nav-items">
            <div class="bottom-nav-item active" data-page="dashboard" onclick="navigateTo('dashboard')">
                <span class="bottom-nav-icon"><i class="bi bi-calendar3"></i></span>
                <span class="bottom-nav-label">Ana Sayfa</span>
            </div>
            <div class="bottom-nav-item" data-page="transactions" onclick="navigateTo('transactions')">
                <span class="bottom-nav-icon"><i class="bi bi-credit-card"></i></span>
                <span class="bottom-nav-label">Ä°ÅŸlemler</span>
            </div>
            <div class="bottom-nav-item bottom-nav-add" onclick="openQuickAdd()">
                <span class="bottom-nav-add-icon"><i class="bi bi-plus-lg"></i></span>
            </div>
            <div class="bottom-nav-item" data-page="debts" onclick="navigateTo('debts')">
                <span class="bottom-nav-icon"><i class="bi bi-cash-stack"></i></span>
                <span class="bottom-nav-label">Ã–demeler</span>
            </div>
            <div class="bottom-nav-item" data-page="profile" onclick="openProfileModal()">
                <span class="bottom-nav-icon"><i class="bi bi-person-circle"></i></span>
                <span class="bottom-nav-label">Profil</span>
            </div>
        </div>
    </nav>

    <!-- Quick Add Panel -->
    <div class="quick-add-panel" id="quickAddPanel">
        <div class="quick-add-header">
            <h3 class="quick-add-title" id="quickAddTitle">HÄ±zlÄ± Ekle</h3>
            <button class="quick-add-close" type="button" aria-label="HÄ±zlÄ± eklemeyi kapat"
                onclick="closeQuickAdd()">Ã—</button>
        </div>
        <form class="quick-add-form" id="quickAddForm" onsubmit="handleQuickAdd(event)">
            <div class="form-group">
                <label class="form-label">TÃ¼r</label>
                <select class="form-input" id="quickType" onchange="updateQuickAddType()">
                    <option value="expense">Gider</option>
                    <option value="income">Gelir</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">Tutar</label>
                <input type="number" class="form-input" id="quickAmount" placeholder="0.00" step="0.01" required>
            </div>
            <div class="form-group">
                <label class="form-label">Kategori</label>
                <select class="form-input" id="quickCategory">
                    <option value="">Kategori seÃ§in</option>
                </select>
            </div>
            <div class="form-group">
                <button type="submit" class="btn btn-primary" style="width: 100%; padding: var(--spacing-md);">
                    Kaydet
                </button>
            </div>
        </form>
        <!-- Kamera Tarama Butonu -->
        <div class="quick-scan-section">
            <button class="btn btn-scan quick-scan-btn" onclick="openScanModal(); closeQuickAdd();">
                <i class="bi bi-camera-fill"></i> FiÅŸ/Fatura Tara
            </button>
        </div>
        <div class="favorites-section">
            <div class="favorites-title">SÄ±k KullanÄ±lanlar</div>
            <div class="favorites-list" id="favoritesList">
                <div class="favorite-item" onclick="quickAddFavorite('market', 'GÄ±da', 'expense')">
                    <span><i class="bi bi-cart3"></i></span>
                    <span>Market</span>
                </div>
                <div class="favorite-item" onclick="quickAddFavorite('akaryakit', 'UlaÅŸÄ±m', 'expense')">
                    <span><i class="bi bi-fuel-pump"></i></span>
                    <span>AkaryakÄ±t</span>
                </div>
                <div class="favorite-item" onclick="quickAddFavorite('yemek', 'GÄ±da', 'expense')">
                    <span><i class="bi bi-egg-fried"></i></span>
                    <span>Yemek</span>
                </div>
                <div class="favorite-item" onclick="quickAddFavorite('maas', 'MaaÅŸ', 'income')">
                    <span><i class="bi bi-cash-coin"></i></span>
                    <span>MaaÅŸ</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Transaction Modal -->
    <div class="modal-overlay" id="addModal">
        <div class="modal" role="dialog" aria-modal="true" aria-labelledby="addModalTitle">
            <div class="modal-header">
                <h3 class="modal-title" id="addModalTitle">Yeni Ä°ÅŸlem</h3>
                <button class="modal-close" type="button" aria-label="Kapat" onclick="closeAddModal()">Ã—</button>
            </div>
            <div class="modal-body">
                <form id="addTransactionForm" onsubmit="handleAddTransaction(event)">
                    <input type="hidden" id="transactionType" value="expense">

                    <!-- Kamera Tarama Butonu -->
                    <div class="scan-shortcut" style="margin-bottom: var(--spacing-lg); text-align: center;">
                        <button type="button" class="btn btn-scan" onclick="closeAddModal(); openScanModal();"
                            style="width: 100%; padding: var(--spacing-md);">
                            <i class="bi bi-camera-fill"></i> FiÅŸ/Fatura Tara ile Otomatik Doldur
                        </button>
                    </div>

                    <div class="form-group" style="margin-bottom: var(--spacing-lg);">
                        <label class="form-label">Tutar *</label>
                        <input type="number" class="form-input" id="transactionAmount" placeholder="0.00" step="0.01"
                            required style="font-size: 1.5rem; text-align: center;">
                    </div>



                    <div class="form-grid-2">
                        <div class="form-group">
                            <label class="form-label">Kategori *</label>
                            <select class="form-input" id="transactionCategory" required>
                                <option value="">SeÃ§in</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Tarih *</label>
                            <input type="date" class="form-input" id="transactionDate" required>
                        </div>
                    </div>

                    <div class="form-group" style="margin-bottom: var(--spacing-lg);">
                        <label class="form-label">AÃ§Ä±klama</label>
                        <input type="text" class="form-input" id="transactionDescription"
                            placeholder="Ä°ÅŸlem aÃ§Ä±klamasÄ±">
                    </div>

                    <div class="form-group" style="margin-bottom: var(--spacing-lg);">
                        <label class="form-label">Etiketler</label>
                        <input type="text" class="form-input" id="transactionTags"
                            placeholder="VirgÃ¼lle ayÄ±rarak yazÄ±n">
                    </div>

                    <div class="form-group" style="margin-bottom: var(--spacing-lg);">
                        <label class="form-label">Not</label>
                        <textarea class="form-input" id="transactionNote" rows="3"
                            placeholder="Ek notlar..."></textarea>
                    </div>

                    <div style="display: flex; align-items: center; gap: var(--spacing-md);">
                        <input type="checkbox" id="transactionRecurring">
                        <label for="transactionRecurring" style="font-size: 0.9rem;">Tekrarlayan iÅŸlem</label>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" type="button" onclick="closeAddModal()">Ä°ptal</button>
                <button class="btn btn-primary" type="button"
                    onclick="document.getElementById('addTransactionForm').requestSubmit()">Kaydet</button>
            </div>
        </div>
    </div>

    <!-- Edit Transaction Modal -->
    <div class="modal-overlay" id="editModal">
        <div class="modal" role="dialog" aria-modal="true" aria-labelledby="editModalTitle">
            <div class="modal-header">
                <h3 class="modal-title" id="editModalTitle">Ä°ÅŸlem DÃ¼zenle</h3>
                <button class="modal-close" type="button" aria-label="Kapat" onclick="closeEditModal()">Ã—</button>
            </div>
            <div class="modal-body">
                <form id="editTransactionForm" onsubmit="handleEditTransaction(event)">
                    <input type="hidden" id="editTransactionId">
                    <input type="hidden" id="editTransactionType">

                    <div class="form-group" style="margin-bottom: var(--spacing-lg);">
                        <label class="form-label">Tutar *</label>
                        <input type="number" class="form-input" id="editTransactionAmount" placeholder="0.00"
                            step="0.01" required style="font-size: 1.5rem; text-align: center;">
                    </div>

                    <div class="form-group" style="margin-bottom: var(--spacing-lg);">
                        <label class="form-label">AÃ§Ä±klama</label>
                        <input type="text" class="form-input" id="editTransactionDescription"
                            placeholder="Ä°ÅŸlem aÃ§Ä±klamasÄ±">
                    </div>

                    <div class="form-grid-2">
                        <div class="form-group">
                            <label class="form-label">Kategori *</label>
                            <select class="form-input" id="editTransactionCategory" required>
                                <option value="">SeÃ§in</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Tarih *</label>
                            <input type="date" class="form-input" id="editTransactionDate" required>
                        </div>
                    </div>

                    <div class="form-group" style="margin-bottom: var(--spacing-lg);">
                        <label class="form-label">Etiketler</label>
                        <input type="text" class="form-input" id="editTransactionTags"
                            placeholder="VirgÃ¼lle ayÄ±rarak yazÄ±n">
                    </div>

                    <div class="form-group" style="margin-bottom: var(--spacing-lg);">
                        <label class="form-label">Not</label>
                        <textarea class="form-input" id="editTransactionNote" rows="3"
                            placeholder="Ek notlar..."></textarea>
                    </div>

                    <div style="display: flex; align-items: center; gap: var(--spacing-md);">
                        <input type="checkbox" id="editTransactionRecurring">
                        <label for="editTransactionRecurring" style="font-size: 0.9rem;">Tekrarlayan iÅŸlem</label>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" type="button" onclick="closeEditModal()">Ä°ptal</button>
                <button class="btn btn-expense" type="button"
                    onclick="TransactionManager.confirmDelete(document.getElementById('editTransactionId').value)">Sil</button>
                <button class="btn btn-primary" type="button"
                    onclick="document.getElementById('editTransactionForm').requestSubmit()">GÃ¼ncelle</button>
            </div>
        </div>
    </div>

    <!-- Search Modal -->
    <div class="modal-overlay" id="searchModal">
        <div class="modal" style="max-width: 500px;" role="dialog" aria-modal="true" aria-labelledby="searchModalTitle">
            <div class="modal-header">
                <h3 class="modal-title" id="searchModalTitle"><i class="bi bi-search"></i> Ara</h3>
                <button class="modal-close" type="button" aria-label="Kapat"
                    onclick="closeSearchModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group" style="margin-bottom: var(--spacing-lg);">
                    <input type="text" class="form-input" id="searchInput" placeholder="Ä°ÅŸlem, kategori veya not ara..."
                        oninput="performSearch(this.value)" aria-label="Arama" autofocus style="font-size: 1.1rem;">
                </div>
                <div id="searchResults" style="max-height: 400px; overflow-y: auto;">
                    <div class="empty-state" style="padding: var(--spacing-xl);">
                        <div class="empty-state-icon"><i class="bi bi-search"></i></div>
                        <div class="empty-state-text">Aramak iÃ§in bir ÅŸeyler yazÄ±n</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Notifications Modal -->
    <div class="modal-overlay" id="notificationsModal">
        <div class="modal" style="max-width: 450px;" role="dialog" aria-modal="true"
            aria-labelledby="notificationsModalTitle">
            <div class="modal-header">
                <h3 class="modal-title" id="notificationsModalTitle"><i class="bi bi-bell"></i> Bildirimler</h3>
                <button class="modal-close" type="button" aria-label="Kapat"
                    onclick="closeNotificationsModal()">&times;</button>
            </div>
            <div class="modal-body" style="padding: 0;">
                <div id="notificationsList" style="max-height: 500px; overflow-y: auto;">
                    <!-- Notifications will be rendered here -->
                </div>
            </div>
            <div class="modal-footer" style="justify-content: center;">
                <button class="btn btn-secondary" type="button" onclick="clearAllNotifications()">TÃ¼mÃ¼nÃ¼
                    Temizle</button>
            </div>
        </div>
    </div>

    <!-- Custom Dialog Modal (Alert, Confirm, Prompt) -->
    <div class="modal-overlay" id="dialogModal">
        <div class="modal dialog-modal" style="max-width: 400px;" role="dialog" aria-modal="true"
            aria-labelledby="dialogTitle" aria-describedby="dialogMessage">
            <div class="modal-header">
                <h3 class="modal-title" id="dialogTitle">Bildirim</h3>
                <button class="modal-close" type="button" aria-label="Kapat" onclick="Dialog.close()">&times;</button>
            </div>
            <div class="modal-body">
                <div id="dialogIcon" style="font-size: 3rem; text-align: center; margin-bottom: var(--spacing-md);"><i
                        class="bi bi-info-circle"></i></div>
                <p id="dialogMessage"
                    style="text-align: center; color: var(--text-secondary); margin-bottom: var(--spacing-lg);"></p>
                <div id="dialogInputGroup" class="form-group hidden" style="margin-bottom: 0;">
                    <input type="text" class="form-input" id="dialogInput" placeholder="">
                </div>
            </div>
            <div class="modal-footer" id="dialogFooter" style="justify-content: center; gap: var(--spacing-md);">
                <button class="btn btn-secondary" type="button" id="dialogCancelBtn"
                    onclick="Dialog.cancel()">Ä°ptal</button>
                <button class="btn btn-primary" type="button" id="dialogConfirmBtn"
                    onclick="Dialog.confirm()">Tamam</button>
            </div>
        </div>
    </div>

    <!-- PIN Entry Modal -->
    <div class="modal-overlay" id="pinModal">
        <div class="modal" style="max-width: 320px;" role="dialog" aria-modal="true" aria-labelledby="pinModalTitle">
            <div class="modal-header">
                <h3 class="modal-title" id="pinModalTitle"><i class="bi bi-lock-fill"></i> PIN GiriÅŸi</h3>
            </div>
            <div class="modal-body" style="text-align: center;">
                <p id="pinModalProfileName" style="color: var(--text-secondary); margin-bottom: var(--spacing-lg);">
                    Profil: KiÅŸisel</p>
                <input type="password" class="form-input" id="pinInput" placeholder="PIN kodunu girin" maxlength="6"
                    pattern="[0-9]*" inputmode="numeric"
                    style="text-align: center; font-size: 1.5rem; letter-spacing: 0.5rem;"
                    onkeyup="checkPinEntry(event)">
                <p id="pinError" class="hidden"
                    style="color: var(--expense-color); margin-top: var(--spacing-sm); font-size: 0.85rem;">YanlÄ±ÅŸ PIN
                    kodu</p>
            </div>
            <div class="modal-footer" style="justify-content: center;">
                <button class="btn btn-secondary" type="button" onclick="closePinModal()">Ä°ptal</button>
                <button class="btn btn-primary" type="button" onclick="verifyPin()">GiriÅŸ</button>
            </div>
        </div>
    </div>

    <!-- Profile Modal -->
    <div class="modal-overlay" id="profileModal">
        <div class="modal" role="dialog" aria-modal="true" aria-labelledby="profileModalTitle">
            <div class="modal-header">
                <h3 class="modal-title" id="profileModalTitle">Profil YÃ¶netimi</h3>
                <button class="modal-close" type="button" aria-label="Kapat" onclick="closeProfileModal()">Ã—</button>
            </div>
            <div class="modal-body">
                <div id="profileList" style="margin-bottom: var(--spacing-lg);">
                    <!-- Profile list will be generated by JS -->
                </div>
                <button class="btn btn-primary" type="button" style="width: 100%;" onclick="openNewProfileForm()">
                    <i class="bi bi-plus-lg"></i> Yeni Profil OluÅŸtur
                </button>

                <div id="newProfileForm" class="hidden"
                    style="margin-top: var(--spacing-lg); padding-top: var(--spacing-lg); border-top: 1px solid var(--border-color);">
                    <div class="form-group" style="margin-bottom: var(--spacing-md);">
                        <label class="form-label">Profil AdÄ± *</label>
                        <input type="text" class="form-input" id="newProfileName"
                            placeholder="Ã–rn: KiÅŸisel, Aile, Ä°ÅŸletme">
                    </div>
                    <div class="form-group" style="margin-bottom: var(--spacing-md);">
                        <label class="form-label">Para Birimi</label>
                        <select class="form-input" id="newProfileCurrency">
                            <option value="TRY">â‚º TÃ¼rk LirasÄ±</option>
                            <option value="USD">$ Amerikan DolarÄ±</option>
                            <option value="EUR">â‚¬ Euro</option>
                            <option value="GBP">Â£ Ä°ngiliz Sterlini</option>
                        </select>
                    </div>
                    <div class="form-group" style="margin-bottom: var(--spacing-md);">
                        <label class="form-label">AÃ§Ä±lÄ±ÅŸ Bakiyesi</label>
                        <input type="number" class="form-input" id="newProfileBalance" placeholder="0.00" step="0.01">
                    </div>
                    <div class="form-group" style="margin-bottom: var(--spacing-md);">
                        <label class="form-label">Profil Ä°konu</label>
                        <div style="display: flex; gap: var(--spacing-sm); flex-wrap: wrap;">
                            <button type="button" class="profile-icon-btn" aria-label="Profil ikonu: KiÅŸi"
                                onclick="selectProfileIcon('bi:person-circle')" data-icon="bi:person-circle"><i
                                    class="bi bi-person-circle"></i></button>
                            <button type="button" class="profile-icon-btn" aria-label="Profil ikonu: Grup"
                                onclick="selectProfileIcon('bi:people')" data-icon="bi:people"><i
                                    class="bi bi-people"></i></button>
                            <button type="button" class="profile-icon-btn" aria-label="Profil ikonu: Bina"
                                onclick="selectProfileIcon('bi:building')" data-icon="bi:building"><i
                                    class="bi bi-building"></i></button>
                            <button type="button" class="profile-icon-btn" aria-label="Profil ikonu: Ev"
                                onclick="selectProfileIcon('bi:house-door')" data-icon="bi:house-door"><i
                                    class="bi bi-house-door"></i></button>
                            <button type="button" class="profile-icon-btn" aria-label="Profil ikonu: Ã‡anta"
                                onclick="selectProfileIcon('bi:briefcase')" data-icon="bi:briefcase"><i
                                    class="bi bi-briefcase"></i></button>
                            <button type="button" class="profile-icon-btn" aria-label="Profil ikonu: Mezuniyet"
                                onclick="selectProfileIcon('bi:mortarboard')" data-icon="bi:mortarboard"><i
                                    class="bi bi-mortarboard"></i></button>
                        </div>
                    </div>
                    <input type="hidden" id="selectedProfileIcon" value="bi:person-circle">
                    <div class="form-group" style="margin-bottom: var(--spacing-md);">
                        <label style="display: flex; align-items: center; gap: var(--spacing-md); cursor: pointer;">
                            <input type="checkbox" id="newProfileLockEnabled" onchange="togglePinInput()">
                            <span><i class="bi bi-lock-fill"></i> PIN ile kilitle</span>
                        </label>
                    </div>
                    <div class="form-group hidden" id="newProfilePinGroup" style="margin-bottom: var(--spacing-md);">
                        <label class="form-label">PIN Kodu (4-6 haneli)</label>
                        <input type="password" class="form-input" id="newProfilePin" placeholder="â€¢â€¢â€¢â€¢" maxlength="6"
                            pattern="[0-9]*" inputmode="numeric">
                    </div>
                    <div style="display: flex; gap: var(--spacing-md);">
                        <button class="btn btn-secondary" type="button" style="flex: 1;"
                            onclick="cancelNewProfile()">Ä°ptal</button>
                        <button class="btn btn-primary" type="button" style="flex: 1;"
                            onclick="createNewProfile()">OluÅŸtur</button>
                    </div>
                </div>
            </div>
        </div>
    </div>



    <!-- Receipt Scanner Modal -->
    <div class="modal-overlay" id="scanModal">
        <div class="modal" style="max-width: 500px;" role="dialog" aria-modal="true" aria-labelledby="scanModalTitle">
            <div class="modal-header">
                <h3 class="modal-title" id="scanModalTitle"><i class="bi bi-camera"></i> FiÅŸ/Fatura Tara</h3>
                <button class="modal-close" type="button" aria-label="Kapat" onclick="closeScanModal()">&times;</button>
            </div>
            <div class="modal-body">
                <!-- YÃ¼kleme SeÃ§enekleri -->
                <div id="uploadContainer">
                    <div class="scan-options">
                        <div class="scan-option" onclick="startCameraScan()">
                            <div class="scan-option-icon"><i class="bi bi-camera-fill"></i></div>
                            <div class="scan-option-title">Kamera ile Ã‡ek</div>
                            <div class="scan-option-desc">FiÅŸi kamera ile fotoÄŸraflayÄ±n</div>
                        </div>
                        <div class="scan-option" onclick="document.getElementById('receiptFileInput').click()">
                            <div class="scan-option-icon"><i class="bi bi-image"></i></div>
                            <div class="scan-option-title">Dosya YÃ¼kle</div>
                            <div class="scan-option-desc">Galeriden fotoÄŸraf seÃ§in</div>
                        </div>
                    </div>
                    <input type="file" id="receiptFileInput" accept="image/*" style="display: none;"
                        onchange="handleFileUpload(event)">

                    <div class="scan-tips">
                        <div class="scan-tips-title"><i class="bi bi-lightbulb"></i> Ä°puÃ§larÄ±</div>
                        <ul>
                            <li>FiÅŸi dÃ¼z bir zemine koyun</li>
                            <li>Ä°yi aydÄ±nlatÄ±lmÄ±ÅŸ ortamda Ã§ekin</li>
                            <li>TÃ¼m yazÄ±larÄ±n gÃ¶rÃ¼nÃ¼r olduÄŸundan emin olun</li>
                        </ul>
                    </div>
                </div>

                <!-- Kamera Ã–nizleme -->
                <div id="cameraContainer" class="hidden">
                    <video id="cameraPreview" autoplay playsinline
                        style="width: 100%; border-radius: var(--radius-lg); background: #000;"></video>
                </div>

                <!-- GÃ¶rÃ¼ntÃ¼ Ã–nizleme -->
                <div id="scanPreviewContainer" class="hidden">
                    <img id="scanPreviewImage"
                        style="width: 100%; border-radius: var(--radius-lg); margin-bottom: var(--spacing-md);">
                    <button class="btn btn-secondary" style="width: 100%;" onclick="retryScanning()">
                        <i class="bi bi-arrow-counterclockwise"></i> Tekrar Dene
                    </button>
                </div>

                <!-- Ä°ÅŸleme Durumu -->
                <div id="scanProcessing" class="hidden" style="text-align: center; padding: var(--spacing-xl);">
                    <div class="scan-spinner"></div>
                    <p id="scanProgressText" style="margin-top: var(--spacing-md); color: var(--text-secondary);">Metin
                        okunuyor... %0</p>
                    <div
                        style="height: 6px; background: var(--bg-input); border-radius: var(--radius-full); overflow: hidden; margin-top: var(--spacing-md);">
                        <div id="scanProgressBar"
                            style="height: 100%; width: 0%; background: var(--accent-gradient); transition: width 0.3s ease;">
                        </div>
                    </div>
                </div>

                <!-- SonuÃ§lar -->
                <div id="scanResults" class="hidden">
                    <div class="scan-result-card">
                        <div class="scan-result-header">
                            <span class="scan-result-label">Tespit Edilen Kategori</span>
                            <div class="scan-result-badge" id="scanResultCategory">
                                <i class="bi bi-box-seam"></i> DiÄŸer
                            </div>
                        </div>

                        <div class="form-group" style="margin-top: var(--spacing-md);">
                            <label class="form-label">Tutar (â‚º)</label>
                            <input type="number" class="form-input" id="scanResultAmount" placeholder="0.00"
                                step="0.01">
                        </div>

                        <div class="form-group">
                            <label class="form-label">Tarih</label>
                            <input type="date" class="form-input" id="scanResultDate">
                        </div>

                        <div class="form-group">
                            <label class="form-label">AÃ§Ä±klama</label>
                            <input type="text" class="form-input" id="scanResultDescription"
                                placeholder="Ä°ÅŸlem aÃ§Ä±klamasÄ±">
                        </div>

                        <div class="scan-confidence">
                            <span id="scanConfidence">%0 doÄŸruluk</span>
                            <div class="scan-confidence-bar">
                                <div id="scanConfidenceBar" style="width: 0%;"></div>
                            </div>
                        </div>

                        <button class="btn btn-link" type="button" onclick="toggleRawText()"
                            style="font-size: 0.85rem; padding: 0; margin-top: var(--spacing-sm);">
                            <i class="bi bi-code"></i> Ham metni gÃ¶ster
                        </button>

                        <div id="rawTextContainer" class="hidden" style="margin-top: var(--spacing-sm);">
                            <textarea class="form-input" id="scanRawText" rows="4" readonly
                                style="font-size: 0.8rem; font-family: monospace;"></textarea>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" type="button" onclick="closeScanModal()">Ä°ptal</button>
                <button class="btn btn-primary" type="button" id="captureBtn" class="hidden" onclick="capturePhoto()">
                    <i class="bi bi-camera"></i> FotoÄŸraf Ã‡ek
                </button>
                <button class="btn btn-primary" type="button" id="addScannedBtn"
                    onclick="ReceiptScanner.addToTransaction()">
                    <i class="bi bi-check-lg"></i> Gider Olarak Ekle
                </button>
            </div>
        </div>
    </div>

    <!-- Main JavaScript -->
    <script src="js/firebase-config.js"></script>
    <script src="js/modules.js"></script>
    <script src="js/receipt-scanner.js"></script>
    <script src="js/app.js"></script>
</body>

</html>